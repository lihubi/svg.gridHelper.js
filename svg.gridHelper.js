(function(n,r){typeof exports=="object"&&typeof module<"u"?r(require("@svgdotjs/svg.js")):typeof define=="function"&&define.amd?define(["@svgdotjs/svg.js"],r):(n=typeof globalThis<"u"?globalThis:n||self,r(n.SVG))})(this,function(n){"use strict";var L=Object.defineProperty;var T=(n,r,b)=>r in n?L(n,r,{enumerable:!0,configurable:!0,writable:!0,value:b}):n[r]=b;var g=(n,r,b)=>(T(n,typeof r!="symbol"?r+"":r,b),b);/*!
* svg-gridhelper.js - An extension for svg.js which adds a grid helper to the svg
* @version 0.0.4
* https://github.com/lihubi/svg.gridHelper.js
*
* @copyright Li Kang
* @license MIT
*
* BUILT: Mon Jun 30 2025 15:04:40 GMT+0800 (中国标准时间)
*/class r{constructor(t,o){g(this,"draw");g(this,"options");g(this,"gridGroup");g(this,"labelGroup");g(this,"visible");g(this,"labelTemplate");g(this,"parentDraw");this.parentDraw=t;const i=t.node.parentNode,s=t.width(),l=t.height();i.style.position="relative",this.draw=n.SVG().addTo(i).size(s,l).css({position:"absolute",top:"0",left:"0","z-index":"1","pointer-events":"none"}),this.options=Object.assign({gridSize:100,minPixels:100,gridColor:"gray",labelColor:"#666",gridStrokeWidth:1,labelFontSize:12,showLabel:!0},o),this.labelTemplate=this.draw.text("").hide(),this.gridGroup=this.draw.group(),this.labelGroup=this.draw.group(),this.visible=!0,this.update()}calculateGridSize(){const t=this.draw.zoom(),o=this.options.minPixels;let s=this.options.gridSize;for(;s*t<o;)s*=2;for(;s*t>o*2;)s/=2;return Math.max(s,5)}update(){if(this.gridGroup.clear(),!this.visible)return;const t=this.parentDraw.zoom(),o=this.parentDraw.viewbox();this.draw.viewbox(o.x,o.y,o.width,o.height),this.draw.zoom(t);const i=this.calculateGridSize(),s=o.x,l=o.y,u=o.width,d=o.height,c=(Math.floor(s/i)-5)*i,m=(Math.ceil((s+u)/i)+5)*i,w=(Math.floor(l/i)-5)*i,x=(Math.ceil((l+d)/i)+5)*i;for(let h=c;h<=m;h+=i)this.gridGroup.line(h,w,h,x).stroke({width:this.options.gridStrokeWidth/t,color:this.options.gridColor,opacity:.7});for(let h=w;h<=x;h+=i)this.gridGroup.line(c,h,m,h).stroke({width:this.options.gridStrokeWidth/t,color:this.options.gridColor,opacity:.7});this.options.showLabel&&this.drawLabels(i,s,l,u,d)}drawLabels(t,o,i,s,l){const u=this.options.labelFontSize,d=new Map;this.labelGroup.children().forEach(e=>{const p=`${e.attr("position")}-${e.text()}`;d.set(p,e)});const c=(e,a,p,M,W,v,S)=>{const G=`${S}-${e}`;d.has(G)?(d.get(G).font("size",v).move(a,p),d.delete(G)):this.createLabel(e,a,p,M,W,v,S)},m=(Math.floor(o/t)-5)*t,w=(Math.ceil((o+s)/t)+5)*t,x=(Math.floor(i/t)-5)*t,h=(Math.ceil((i+l)/t)+5)*t,y=1/this.draw.zoom(),f=u*y,z=this.getNumberWidth();for(let e=m;e<=w;e+=t){const a=e,p=e.toString().length*z;c(e.toString(),a-p/2,i,"middle","auto",f,"top")}for(let e=m;e<=w;e+=t){const a=e,p=e.toString().length*z;c(e.toString(),a-p/2,l-f+i,"middle","auto",f,"bottom")}for(let e=x;e<=h;e+=t){const a=e;c(e.toString(),o,a-f/2,"start","middle",f,"left")}for(let e=x;e<=h;e+=t){const a=e,p=e.toString().length*z;c(e.toString(),o+s-p,a-f/2,"end","middle",f,"right")}d.forEach(e=>e.remove())}createLabel(t,o,i,s,l,u,d){const c=this.labelTemplate.clone().text(t).font({size:u,family:"Arial, sans-serif"}).fill(this.options.labelColor).attr({"text-anchor":s,"dominant-baseline":l,"pointer-events":"none",style:"user-select: none;",position:d}).move(o,i).show();this.labelGroup.add(c),c.front()}toggle(t){t!==void 0?this.visible=t:this.visible=!this.visible,this.visible?(this.gridGroup.show(),this.labelGroup.show(),this.update()):(this.gridGroup.hide(),this.labelGroup.hide())}updateOptions(t){Object.assign(this.options,t),this.update()}getNumberWidth(){const o=1/this.draw.zoom(),s=this.options.labelFontSize*o,l=this.labelTemplate.clone().text("0").font({size:s,family:"Arial, sans-serif"}),u=l.bbox();return l.remove(),u.width}resize(){const t=this.parentDraw.width(),o=this.parentDraw.height();this.draw.size(t,o),this.update()}destroy(){this.gridGroup.remove(),this.labelGroup.remove()}}n.extend(n.Svg,{gridHelper(b){const t=new r(this,b);return this.gridHelper=t,this}})});
//# sourceMappingURL=svg.gridhelper.js.map
